extends ../layouts/default

include ../mixins/commenting
include ../mixins/submissions



block content
	.container: .jumbotron
		h1 Welcome

		hr
		//-comments
		.container: .row
			.col-sm-6
				+submission-form()
			hr
			if data.submissions.results.length
				if data.submissions.totalPages > 1
					h4.text-weight-normal Showing 
						strong #{data.submissions.first}
						|  to 
						strong #{data.submissions.last}
						|  of 
						strong #{data.submissions.total}
						|  submissions.
				else
					h4.text-weight-normal Showing #{utils.plural(data.submissions.results.length, '* submission')}.
			.col-sm-6
				each submission in data.submissions.results
					+submission(submission)
							
				//- if data.posts.totalPages > 1
				//- 	ul.pagination
				//- 		if data.posts.previous
				//- 			li: a(href='?page=' + data.posts.previous): span.glyphicon.glyphicon-chevron-left
				//- 		else
				//- 			li.disabled: a(href='?page=' + 1): span.glyphicon.glyphicon-chevron-left
				//- 		each p, i in data.posts.pages
				//- 			li(class=data.posts.currentPage == p ? 'active' : null)
				//- 				a(href='?page=' + (p == '...' ? (i ? data.posts.totalPages : 1) : p ))= p
				//- 		if data.posts.next
				//- 			li: a(href='?page=' + data.posts.next): span.glyphicon.glyphicon-chevron-right
				//- 		else
				//- 			li.disabled: a(href='?page=' + data.posts.totalPages): span.entypo.glyphicon.glyphicon-chevron-right
				

block js
	script.
		jQuery(function($) {
			
			var comments = $('#comments');
			var input = $('.comment-field-input');
			var submit = comments.find('button[type=submit]');

			
			// Scroll to comments and focus input field
			function scrollToComments(e) {
				
				e.preventDefault();
				
				$('html, body').animate({ scrollTop: comments.offset().top }, 250);
				
				input.eq(0).focus();
			}
			$('[href="#comments"]').click( scrollToComments );
			
			
			
			// Check if field has content: enable/disable submit. Disable by default
			submit.attr('disabled','disabled');
			input.keyup(function() {
				if ($.trim($(this).val())) {
					submit.removeAttr('disabled');
				} else {
					submit.attr('disabled','disabled');
				}
			});
		});

